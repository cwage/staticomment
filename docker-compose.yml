services:
  staticomment:
    build: .
    ports:
      - "8080:8080"
    environment:
      STATICOMMENT_GIT_REPO: "${STATICOMMENT_GIT_REPO}"
      STATICOMMENT_BRANCH: "${STATICOMMENT_BRANCH:-main}"
      STATICOMMENT_COMMENTS_PATH: "${STATICOMMENT_COMMENTS_PATH:-_data/comments}"
      STATICOMMENT_PORT: "8080"
      STATICOMMENT_ALLOWED_ORIGINS: "${STATICOMMENT_ALLOWED_ORIGINS}"
      STATICOMMENT_SSH_KEY_PATH: "/app/.ssh/id_ed25519"
      STATICOMMENT_POSTS_PATH: "${STATICOMMENT_POSTS_PATH:-}"
      STATICOMMENT_SSH_INSECURE: "${STATICOMMENT_SSH_INSECURE:-0}"
      STATICOMMENT_HONEYPOT_FIELD: "${STATICOMMENT_HONEYPOT_FIELD:-website}"
      STATICOMMENT_RATE_LIMIT_WINDOW: "${STATICOMMENT_RATE_LIMIT_WINDOW:-60}"
      STATICOMMENT_RATE_LIMIT_MAX: "${STATICOMMENT_RATE_LIMIT_MAX:-5}"
      STATICOMMENT_MAX_LINKS: "${STATICOMMENT_MAX_LINKS:-3}"
      STATICOMMENT_BLOCKED_PATTERNS: "${STATICOMMENT_BLOCKED_PATTERNS:-}"
      STATICOMMENT_MIN_SUBMIT_TIME: "${STATICOMMENT_MIN_SUBMIT_TIME:-5}"
    volumes:
      - "${SSH_KEY_PATH:-~/.ssh/id_ed25519}:/app/.ssh/id_ed25519:ro"
    restart: unless-stopped
